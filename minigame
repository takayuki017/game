<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¢ã‚°ãƒ©ãŸãŸãã‚²ãƒ¼ãƒ </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Interãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* ã‚²ãƒ¼ãƒ ãƒœãƒ¼ãƒ‰ã®ã‚°ãƒªãƒƒãƒ‰è¨­å®š */
        .game-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* 3åˆ— */
            gap: 1rem; /* ã‚°ãƒªãƒƒãƒ‰é–“ã®éš™é–“ */
            width: 100%;
            max-width: 500px; /* æœ€å¤§å¹…ã‚’è¨­å®š */
            margin: 0 auto; /* ä¸­å¤®æƒãˆ */
        }
        /* ãƒ¢ã‚°ãƒ©ã®ç©´ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .hole {
            width: 100%;
            padding-bottom: 100%; /* ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”1:1ã‚’ç¶­æŒ */
            background-color: #a0522d; /* èŒ¶è‰² */
            border-radius: 50%; /* å††å½¢ */
            position: relative;
            overflow: hidden;
            cursor: pointer;
            border: 4px solid #8b4513; /* æ¿ƒã„èŒ¶è‰²ã®æ ç·š */
            box-shadow: inset 0 0 10px rgba(0,0,0,0.3); /* å†…å´ã®å½± */
        }
        /* ãƒ¢ã‚°ãƒ©ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .mole {
            position: absolute;
            top: 100%; /* æœ€åˆã¯ç©´ã®ä¸‹ã«éš ã™ */
            left: 50%;
            transform: translate(-50%, 0);
            width: 80%;
            height: 80%;
            background-color: #654321; /* ãƒ¢ã‚°ãƒ©ã®è‰² */
            border-radius: 50%; /* å††å½¢ */
            transition: top 0.2s ease-out; /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
            box-shadow: 0 5px 10px rgba(0,0,0,0.3); /* å½± */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem; /* ãƒ¢ã‚°ãƒ©ã®é¡”ã®ã‚µã‚¤ã‚º */
            line-height: 1; /* è¡Œã®é«˜ã• */
            color: #fff; /* ãƒ¢ã‚°ãƒ©ã®é¡”ã®è‰² */
            user-select: none; /* ãƒ†ã‚­ã‚¹ãƒˆé¸æŠã‚’ç„¡åŠ¹åŒ– */
        }
        /* ãƒ¢ã‚°ãƒ©ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹çŠ¶æ…‹ */
        .mole.up {
            top: 10%; /* ç©´ã‹ã‚‰é£›ã³å‡ºã™ä½ç½® */
        }
        /* ãƒœã‚¿ãƒ³ã®å…±é€šã‚¹ã‚¿ã‚¤ãƒ« */
        .game-button {
            @apply px-6 py-3 rounded-lg font-bold text-white shadow-lg transition-all duration-300 ease-in-out;
            border: none;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        /* ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .start-button {
            @apply bg-green-600 hover:bg-green-700;
        }
        /* ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .reset-button {
            @apply bg-blue-600 hover:bg-blue-700;
        }
        /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .message-box {
            @apply fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50;
        }
        .message-content {
            @apply bg-white p-8 rounded-lg shadow-xl text-center max-w-sm w-full;
        }
        .message-content button {
            @apply mt-4 px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-green-300 to-blue-400 min-h-screen flex flex-col items-center justify-center p-4">

    <div class="bg-white p-8 rounded-xl shadow-2xl text-center max-w-2xl w-full">
        <h1 class="text-4xl font-extrabold text-gray-800 mb-6">ãƒ¢ã‚°ãƒ©ãŸãŸãã‚²ãƒ¼ãƒ </h1>

        <div class="flex justify-around items-center mb-6 text-xl font-semibold text-gray-700">
            <div class="flex flex-col items-center">
                <span class="text-sm text-gray-500">ã‚¹ã‚³ã‚¢</span>
                <span id="score" class="text-3xl text-purple-600">0</span>
            </div>
            <div class="flex flex-col items-center">
                <span class="text-sm text-gray-500">æ®‹ã‚Šæ™‚é–“</span>
                <span id="time" class="text-3xl text-red-600">30</span>
            </div>
        </div>

        <div class="game-grid mb-8">
            </div>

        <div class="flex justify-center space-x-4">
            <button id="startButton" class="game-button start-button">ã‚²ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
            <button id="resetButton" class="game-button reset-button" disabled>ãƒªã‚»ãƒƒãƒˆ</button>
        </div>
    </div>

    <div id="messageBox" class="message-box hidden">
        <div class="message-content">
            <p id="messageText" class="text-xl font-semibold text-gray-800"></p>
            <button id="messageCloseButton">OK</button>
        </div>
    </div>

    <script>
        const gameGrid = document.querySelector('.game-grid');
        const scoreDisplay = document.getElementById('score');
        const timeDisplay = document.getElementById('time');
        const startButton = document.getElementById('startButton');
        const resetButton = document.getElementById('resetButton');
        const messageBox = document.getElementById('messageBox');
        const messageText = document.getElementById('messageText');
        const messageCloseButton = document.getElementById('messageCloseButton');

        let score = 0;
        let time = 30; // ã‚²ãƒ¼ãƒ æ™‚é–“ (ç§’)
        let gameInterval; // ãƒ¢ã‚°ãƒ©å‡ºç¾ã®é–“éš”ã‚’åˆ¶å¾¡ã™ã‚‹ã‚¿ã‚¤ãƒãƒ¼
        let gameTimer; // ã‚²ãƒ¼ãƒ å…¨ä½“ã®æ™‚é–“ã‚’åˆ¶å¾¡ã™ã‚‹ã‚¿ã‚¤ãƒãƒ¼
        let lastHole; // å‰å›ãƒ¢ã‚°ãƒ©ãŒå‡ºãŸç©´ã‚’è¨˜éŒ²
        let isGameActive = false; // ã‚²ãƒ¼ãƒ ãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‹ã©ã†ã‹

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
        function showMessageBox(message) {
            messageText.textContent = message;
            messageBox.classList.remove('hidden');
        }

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ã‚’éè¡¨ç¤ºã«ã™ã‚‹é–¢æ•°
        messageCloseButton.addEventListener('click', () => {
            messageBox.classList.add('hidden');
        });

        // ãƒ©ãƒ³ãƒ€ãƒ ãªæ™‚é–“ (ãƒŸãƒªç§’) ã‚’ç”Ÿæˆ
        function randomTime(min, max) {
            return Math.round(Math.random() * (max - min) + min);
        }

        // ãƒ©ãƒ³ãƒ€ãƒ ãªç©´ã‚’é¸æŠ
        function randomHole(holes) {
            const idx = Math.floor(Math.random() * holes.length);
            const hole = holes[idx];
            // å‰å›ã¨åŒã˜ç©´ãŒå‡ºãªã„ã‚ˆã†ã«ã™ã‚‹
            if (hole === lastHole) {
                return randomHole(holes);
            }
            lastHole = hole;
            return hole;
        }

        // ãƒ¢ã‚°ãƒ©ã‚’å‡ºç¾ã•ã›ã‚‹
        function peep() {
            if (!isGameActive) return; // ã‚²ãƒ¼ãƒ ãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã§ãªã„å ´åˆã¯ä½•ã‚‚ã—ãªã„

            const holes = Array.from(document.querySelectorAll('.hole'));
            const hole = randomHole(holes);
            const mole = hole.querySelector('.mole');

            mole.classList.add('up'); // ãƒ¢ã‚°ãƒ©ã‚’ç©´ã‹ã‚‰å‡ºã™

            const timeToPeep = randomTime(500, 1500); // ãƒ¢ã‚°ãƒ©ãŒå‡ºã¦ã„ã‚‹æ™‚é–“
            setTimeout(() => {
                mole.classList.remove('up'); // ãƒ¢ã‚°ãƒ©ã‚’ç©´ã«æˆ»ã™
                if (isGameActive) {
                    peep(); // æ¬¡ã®ãƒ¢ã‚°ãƒ©ã‚’å‡ºç¾ã•ã›ã‚‹
                }
            }, timeToPeep);
        }

        // ã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã™ã‚‹
        function startGame() {
            score = 0;
            time = 30;
            scoreDisplay.textContent = score;
            timeDisplay.textContent = time;
            isGameActive = true;
            startButton.disabled = true; // ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
            resetButton.disabled = false; // ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–

            // ã™ã¹ã¦ã®ãƒ¢ã‚°ãƒ©ã‚’åˆæœŸä½ç½®ã«æˆ»ã™
            document.querySelectorAll('.mole').forEach(mole => mole.classList.remove('up'));

            peep(); // æœ€åˆã®ãƒ¢ã‚°ãƒ©ã‚’å‡ºç¾ã•ã›ã‚‹

            // ã‚²ãƒ¼ãƒ ã‚¿ã‚¤ãƒãƒ¼ã‚’é–‹å§‹
            gameTimer = setInterval(() => {
                time--;
                timeDisplay.textContent = time;
                if (time <= 0) {
                    endGame(); // æ™‚é–“åˆ‡ã‚Œã§ã‚²ãƒ¼ãƒ çµ‚äº†
                }
            }, 1000);
        }

        // ã‚²ãƒ¼ãƒ ã‚’çµ‚äº†ã™ã‚‹
        function endGame() {
            isGameActive = false;
            clearInterval(gameInterval); // ãƒ¢ã‚°ãƒ©å‡ºç¾ã‚¿ã‚¤ãƒãƒ¼ã‚’åœæ­¢
            clearInterval(gameTimer); // ã‚²ãƒ¼ãƒ ã‚¿ã‚¤ãƒãƒ¼ã‚’åœæ­¢
            startButton.disabled = false; // ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
            resetButton.disabled = false; // ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
            // ã™ã¹ã¦ã®ãƒ¢ã‚°ãƒ©ã‚’éš ã™
            document.querySelectorAll('.mole').forEach(mole => mole.classList.remove('up'));
            showMessageBox(`ã‚²ãƒ¼ãƒ çµ‚äº†ï¼ã‚ãªãŸã®ã‚¹ã‚³ã‚¢ã¯ ${score} ã§ã™ï¼`);
        }

        // ãƒ¢ã‚°ãƒ©ã‚’å©ã„ãŸæ™‚ã®å‡¦ç†
        function whack(event) {
            if (!isGameActive) return; // ã‚²ãƒ¼ãƒ ãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã§ãªã„å ´åˆã¯ä½•ã‚‚ã—ãªã„
            if (!event.isTrusted) return; // ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«ã‚ˆã‚‹ã‚¯ãƒªãƒƒã‚¯ã‚’ç„¡è¦– (ãƒãƒ¼ãƒˆå¯¾ç­–)

            const mole = event.target;
            if (mole.classList.contains('mole') && mole.classList.contains('up')) {
                score++;
                mole.classList.remove('up'); // ãƒ¢ã‚°ãƒ©ã‚’éš ã™
                scoreDisplay.textContent = score;
            }
        }

        // ã‚²ãƒ¼ãƒ ãƒœãƒ¼ãƒ‰ã«ãƒ¢ã‚°ãƒ©ã®ç©´ã‚’ç”Ÿæˆ
        function createHoles(numHoles) {
            for (let i = 0; i < numHoles; i++) {
                const hole = document.createElement('div');
                hole.classList.add('hole');
                const mole = document.createElement('div');
                mole.classList.add('mole');
                mole.textContent = 'ğŸ˜¬'; // ãƒ¢ã‚°ãƒ©ã®é¡”ã®çµµæ–‡å­—
                hole.appendChild(mole);
                gameGrid.appendChild(hole);
                hole.addEventListener('click', whack); // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
            }
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        startButton.addEventListener('click', startGame);
        resetButton.addEventListener('click', () => {
            endGame(); // ã‚²ãƒ¼ãƒ ã‚’çµ‚äº†
            score = 0;
            time = 30;
            scoreDisplay.textContent = score;
            timeDisplay.textContent = time;
            startButton.disabled = false; // ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
            resetButton.disabled = true; // ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
            showMessageBox('ã‚²ãƒ¼ãƒ ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã—ãŸã€‚');
        });

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒ¢ã‚°ãƒ©ã®ç©´ã‚’ç”Ÿæˆ (9å€‹)
        window.onload = function() {
            createHoles(9);
        };
    </script>
</body>
</html>
